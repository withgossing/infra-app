global:
  # SMTP ì„œë²„ ì„¤ì • (ì´ë©”ì¼ ì•Œë¦¼ìš©)
  smtp_smarthost: 'localhost:587'
  smtp_from: 'alertmanager@company.com'
  smtp_auth_username: 'alertmanager@company.com'
  smtp_auth_password: 'your_email_password'
  smtp_require_tls: true

# ì•Œë¦¼ ê²½ë¡œ ì„¤ì •
route:
  group_by: ['alertname', 'cluster', 'service']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 1h
  receiver: 'default-receiver'
  routes:
    # ì¤‘ìš”í•œ ì•Œë¦¼ì€ ì¦‰ì‹œ ì „ì†¡
    - match:
        severity: critical
      receiver: 'critical-alerts'
      group_wait: 5s
      repeat_interval: 30m
      
    # ê²½ê³  ì•Œë¦¼ì€ ê·¸ë£¹í™”í•´ì„œ ì „ì†¡
    - match:
        severity: warning
      receiver: 'warning-alerts'
      group_wait: 30s
      group_interval: 5m
      repeat_interval: 2h
      
    # ì¸í”„ë¼ ê´€ë ¨ ì•Œë¦¼
    - match:
        category: infrastructure
      receiver: 'infrastructure-team'
      
    # ì• í”Œë¦¬ì¼€ì´ì…˜ ê´€ë ¨ ì•Œë¦¼
    - match:
        category: application
      receiver: 'dev-team'
      
    # ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ ì•Œë¦¼
    - match:
        category: database
      receiver: 'dba-team'
      
    # ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ì•Œë¦¼
    - match:
        category: monitoring
      receiver: 'monitoring-team'

# ì•Œë¦¼ ì–µì œ ê·œì¹™
inhibit_rules:
  # ì¸ìŠ¤í„´ìŠ¤ê°€ ë‹¤ìš´ë˜ë©´ í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ì˜ ë‹¤ë¥¸ ì•Œë¦¼ë“¤ì€ ì–µì œ
  - source_match:
      alertname: 'InstanceDown'
    target_match_re:
      instance: '.*'
    equal: ['instance']
    
  # ë†’ì€ ì‹¬ê°ë„ ì•Œë¦¼ì´ ìˆìœ¼ë©´ ë‚®ì€ ì‹¬ê°ë„ ì•Œë¦¼ì€ ì–µì œ
  - source_match:
      severity: 'critical'
    target_match:
      severity: 'warning'
    equal: ['alertname', 'instance']

# ìˆ˜ì‹ ì ì„¤ì •
receivers:
  # ê¸°ë³¸ ìˆ˜ì‹ ì
  - name: 'default-receiver'
    email_configs:
      - to: 'admin@company.com'
        subject: '[Alert] {{ .GroupLabels.alertname }}'
        body: |
          {{ range .Alerts }}
          ì•Œë¦¼: {{ .Annotations.summary }}
          ìƒì„¸: {{ .Annotations.description }}
          ì‹œê°„: {{ .StartsAt }}
          ë¼ë²¨: {{ range .Labels.SortedPairs }}{{ .Name }}={{ .Value }} {{ end }}
          {{ end }}

  # ì¤‘ìš”í•œ ì•Œë¦¼ ìˆ˜ì‹ ì (SMS, ì „í™” ë“± ì¶”ê°€ ê°€ëŠ¥)
  - name: 'critical-alerts'
    email_configs:
      - to: 'admin@company.com, oncall@company.com'
        subject: '[CRITICAL] {{ .GroupLabels.alertname }}'
        body: |
          ğŸš¨ ì¤‘ìš”í•œ ì•Œë¦¼ì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤!
          
          {{ range .Alerts }}
          ì•Œë¦¼: {{ .Annotations.summary }}
          ìƒì„¸: {{ .Annotations.description }}
          ì‹œê°„: {{ .StartsAt }}
          ë¼ë²¨: {{ range .Labels.SortedPairs }}{{ .Name }}={{ .Value }} {{ end }}
          {{ end }}
          
          ì¦‰ì‹œ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.
    # Slack ì•Œë¦¼ (ì„ íƒì‚¬í•­)
    # slack_configs:
    #   - api_url: 'YOUR_SLACK_WEBHOOK_URL'
    #     channel: '#alerts-critical'
    #     title: '[CRITICAL] {{ .GroupLabels.alertname }}'
    #     text: |
    #       {{ range .Alerts }}
    #       ì•Œë¦¼: {{ .Annotations.summary }}
    #       ìƒì„¸: {{ .Annotations.description }}
    #       {{ end }}

  # ê²½ê³  ì•Œë¦¼ ìˆ˜ì‹ ì
  - name: 'warning-alerts'
    email_configs:
      - to: 'team@company.com'
        subject: '[WARNING] {{ .GroupLabels.alertname }}'
        body: |
          âš ï¸ ê²½ê³  ì•Œë¦¼
          
          {{ range .Alerts }}
          ì•Œë¦¼: {{ .Annotations.summary }}
          ìƒì„¸: {{ .Annotations.description }}
          ì‹œê°„: {{ .StartsAt }}
          {{ end }}

  # ì¸í”„ë¼ íŒ€ ìˆ˜ì‹ ì
  - name: 'infrastructure-team'
    email_configs:
      - to: 'infra-team@company.com'
        subject: '[Infrastructure] {{ .GroupLabels.alertname }}'
        body: |
          ğŸ—ï¸ ì¸í”„ë¼ ê´€ë ¨ ì•Œë¦¼
          
          {{ range .Alerts }}
          ì•Œë¦¼: {{ .Annotations.summary }}
          ìƒì„¸: {{ .Annotations.description }}
          ì¸ìŠ¤í„´ìŠ¤: {{ .Labels.instance }}
          ì‹œê°„: {{ .StartsAt }}
          {{ end }}

  # ê°œë°œ íŒ€ ìˆ˜ì‹ ì
  - name: 'dev-team'
    email_configs:
      - to: 'dev-team@company.com'
        subject: '[Application] {{ .GroupLabels.alertname }}'
        body: |
          ğŸ’» ì• í”Œë¦¬ì¼€ì´ì…˜ ê´€ë ¨ ì•Œë¦¼
          
          {{ range .Alerts }}
          ì•Œë¦¼: {{ .Annotations.summary }}
          ìƒì„¸: {{ .Annotations.description }}
          ì„œë¹„ìŠ¤: {{ .Labels.job }}
          ì‹œê°„: {{ .StartsAt }}
          {{ end }}

  # DBA íŒ€ ìˆ˜ì‹ ì
  - name: 'dba-team'
    email_configs:
      - to: 'dba-team@company.com'
        subject: '[Database] {{ .GroupLabels.alertname }}'
        body: |
          ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ ì•Œë¦¼
          
          {{ range .Alerts }}
          ì•Œë¦¼: {{ .Annotations.summary }}
          ìƒì„¸: {{ .Annotations.description }}
          ë°ì´í„°ë² ì´ìŠ¤: {{ .Labels.instance }}
          ì‹œê°„: {{ .StartsAt }}
          {{ end }}

  # ëª¨ë‹ˆí„°ë§ íŒ€ ìˆ˜ì‹ ì
  - name: 'monitoring-team'
    email_configs:
      - to: 'monitoring-team@company.com'
        subject: '[Monitoring] {{ .GroupLabels.alertname }}'
        body: |
          ğŸ“Š ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ê´€ë ¨ ì•Œë¦¼
          
          {{ range .Alerts }}
          ì•Œë¦¼: {{ .Annotations.summary }}
          ìƒì„¸: {{ .Annotations.description }}
          ì‹œê°„: {{ .StartsAt }}
          {{ end }}

# ì›¹í›… ì˜ˆì‹œ (ì„ íƒì‚¬í•­)
# - name: 'webhook-receiver'
#   webhook_configs:
#     - url: 'http://your-webhook-endpoint.com/webhook'
#       send_resolved: true

# PagerDuty ì˜ˆì‹œ (ì„ íƒì‚¬í•­)
# - name: 'pagerduty-receiver'
#   pagerduty_configs:
#     - service_key: 'YOUR_PAGERDUTY_SERVICE_KEY'
#       description: '{{ .GroupLabels.alertname }}'

# í…œí”Œë¦¿ ì„¤ì • (ì„ íƒì‚¬í•­)
templates:
  - '/etc/alertmanager/templates/*.tmpl'
